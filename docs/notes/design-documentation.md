---
title: 设计文档
lang: zh
date: 2024-01-15 23:17:00
description: 设计文档是程序员清晰表达需求和设计思路的重要工具。
---

[[toc]]

## 概要

* **介绍正在解决的问题**
  * 明确指出当前正在处理的问题是什么。需要对问题进行清晰而简洁的描述，使读者能够理解问题的本质和范围。
* **并说明为什么它值得被解决**
  * 解释为什么这个问题需要被解决。可能需要提及该问题的重要性、影响范围、潜在的好处或可能带来的改善。通过说明问题的价值，可以增强解决该问题的必要性和动力。

除了以上内容，还需要简述当前的方向背景，以及当前需求因何而创建，为何值得被解决。

## 现状与背景

* **描述正在修改的结构并定义专有名词，解释那些名字不显眼的系统是干什么的**
  * 对正在进行修改的结构进行清晰而详细的描述。需要说明修改的内容、修改的目的以及修改对整个结构的影响。
  * 对于那些名字不太起眼或不太为人所知的系统，进行解释和说明。这些系统可能在整个结构中扮演着重要的角色，但它们的名字可能不太突出或不太容易理解。通过解释这些系统的功能或作用，可以帮助读者更好地理解整个结构的运作。
* **谈谈目前解决响应问题的方法**
  * “谈谈”：表示要对某个主题进行讨论或交流。
  * “目前”：强调时间上的即时性，指的是当前的情况或现状。
  * “解决响应问题的方法”：这是核心部分，明确了要讨论的主题是关于解决响应问题的方法。响应问题可以是各种类型的问题，例如技术系统的响应时间、客户服务的响应速度、市场需求的响应等。
* **是否正在采用的变通方式**
  * 此部分需要说明当前是否正在使用某种变通方式来解决问题或应对情况。它可能涉及到各种场景。比如工作、项目、流程等，目的是了解当前的解决方案是否为变通方式，以便进一步评估其有效性或考虑其他可能的选择。
* **它们的缺点是什么**
  * 这里的它们指的是上文中的响应方案、变通方式等。
  * 在进行调研预设时，通常会准备两种及以上的可行性方案，并详细说明它们各自的利弊。这样做有助于为后续方案的确定奠定基础。

## 需求

* 面向用户的需求。
* 技术需求。
* 安全与合规性需求。
* 其他。

在此，我们需要简要介绍需求的背景，并对需求进行分类说明。

## 变更的目的
* **为什么这个特别的问题值得去解决**
  * 对某个特别的问题进行分析，以确定其为什么值得解决。可能需要考虑该问题的重要性、影响范围、潜在的好处或可能带来的改善等方面。
  * 通过回答这个问题，可以帮助人们更好地理解解决该问题的意义和动机。
* **描述这项工作将带来的好处，把这些好处与业务需求联系起来（不要过度承诺）**
  * 明确指出完成这项工作后能够获得的益处或优势。这些好处可能包括提高效率、降低成本、增加收益、提升质量等。
  * 列举的好处与组织或业务的需求相联系。这意味着要解释为什么这些好处对业务目标的实现至关重要，以及它们如何与业务战略、客户需求或其他相关因素相契合。
  * **<a>“不要过度承诺”</a>**，这是一个提醒，意味着在描述好处时要保持实事求是，不要夸大或过度承诺。过度承诺可能导致失望或不信任，如果最终无法实现所承诺的好处。

## 系统构成图
* **展示主要组件和它们如何互动的图例，突显出正在发生的变化**
  * 展示系统、流程或概念中的关键组成部分。这些组件可以是硬件设备、软件模块、人员角色、业务流程等。
  * 使用图示或图表来表示主要组件之间的关系和相互作用。图例可以是流程图、系统架构图、数据流程图等，用于说明组件之间的信息流、数据流动、控制流程等。
  * 强调当前正在发生的变化或变革。这些变化可以是新的流程改进、系统升级、业务策略调整等。通过突出变化，可以更容易地理解和关注到关键的转变点。

系统构成图对于读者理解这些变化以及快速把握架构设计的思维逻辑往往是必要的。

## 潜在的解决方案
* **暂定的第一个想法，思考其他的想法和它们之间的利弊**
  * 写下你初步暂定的第一想法，但还没有最终确定。这个想法可能是在当前情况下最合适的，但需要进一步考虑和评估。
  * 找到一个解决方案并不意味着停止思考。我们还需要考虑其他可能的解决方案或思路。通过思考其他的想法，我们可以拓展思维，发现更多的选择和可能性。
  * 对不同想法进行比较和权衡。需要评估每个想法的优点和缺点，考虑它们在不同方面的影响和效果。
* **描述合理的替代方案，以及你为什么拒绝它们**
  * 明确并阐述其他可行的替代方案。这些替代方案应该是经过认真考虑和分析的，具有一定的合理性和可行性。
  * 解释拒绝这些替代方案的原因。需要说明为什么这些替代方案不适合当前的情况或不能满足特定的需求。

## 建议的解决方案
**提供比概述更为详尽和深入的信息。这通常意味着包括更多的细节、步骤、功能、过程和可能的实施策略。分析这句话可以分解成以下几个要点：**
* **详细性：** 描述解决方案时，应该提供充分的细节，不仅要阐明解决方案是什么，还要解释为什么选择这个方案以及如何工作的。
* **完整性：** 需要确保涵盖解决方案的所有重要方面，包括关键组件、所需资源、涉及的技术等。
* **步骤清晰：** 如果解决方案涉及多个步骤或阶段，应该按顺序详细说明每个步骤，并描述其目的和预期结果。
* **功能说明：** 对于涉及技术或产品的解决方案，应详细说明其功能特性以及它们如何满足项目需求。
* **过程概述：** 提供实施解决方案的具体过程，包括计划、时间表、责任分配和监控机制。
* **策略阐述：** 如果有特定的实施策略，如分阶段实施、测试和反馈机制等，也需要详细说明。
* **期望效果：** 对于预期的结果和优势，应当给出具体的描述，比如如何提升效率、节约成本或改善服务。
* **风险评估：** 可能的风险和挑战应在描述中被识别，并提供应对这些风险的方法或缓解措施。
* **对比其他方案：** 可能需要解释为何该方案优于其他备选方案，包括成本效益分析、性能比较等。

通过详细的描述，目的是让读者应能够获得对所提解决方案全面的理解，包括它是如何被选择的、将如何被执行的，以及它预期将带来什么样的效果。

## 设计与架构
**利用的关键类库和框架、实施模式、以及任何与公司常见做法不同的地方。特别要注重阐述以下几个方面：**
* **关键类库和框架：**
  * 描述： 列出并描述解决方案依赖的主要类库和框架，提供它们的版本信息，以及为何选择这些工具。
  * 作用： 阐明每个类库和框架的作用以及如何集成到整体解决方案中。
  * 替代方案： 如果有考虑过其他类库和框架，简要说明为何没有选择它们。
* **实施模式：**
  * 方法论： 描述解决方案采用的开发方法论或实施模式，如敏捷开发、DevOps实践等。
  * 实施步骤： 详细列出解决方案实施的步骤、阶段和里程碑。
  * 预期输出： 对每个实施步骤的预期产出进行描述，包括任何中间产物和最终交付物。
* **与公司常见做法的差异：**
  * 差异点： 明确指出所提出的解决方案在哪些方面与公司的常规做法不同。
  * 理由： 解释为什么会有这些差异，包括不同做法背后的业务需求、技术优势或效率提升。
  * 影响评估： 分析这些差异对团队、流程、工具和项目交付可能产生的影响。

* 应该包括组件的示意图、调用流程和数据流、用户界面、代码、API和模式模拟。

## UI/UX变更点
* 如果你的项目改变了用户界面，请创建原型，用原型的方式来预演用户的动作流。
* 如果你的变更没有可视化的组件，这部分可以讨论开发者对于你正在创建的类库的使用体验，或者描述用户使用你的命令行工具的方式。

## 代码变更点
**描述你的具体实现的过程**
* **具体实现：** 强调需要描述的是实践中的具体操作，而不是理论上的概念。这通常包括实际编写的代码、算法逻辑、数据结构的修改、数据库的变更等。
* **过程：** 指出需要一个按时间顺序的步骤描述，解释从开始到结束如何实施这些变更，包括中间可能经历的问题和决策点。
* **代码变更：** 专注于代码层面的变化，这可能涉及新增代码、修改现有代码、重构部分代码或完全删除某些代码。
* **目的和动机：** 需要阐释进行这些代码变更的原因，例如是为了添加新功能、修复已知缺陷、提高性能、提升用户体验还是保持代码的可维护性。
* **上下文关联：** 解释这些代码变更是如何与项目的其他部分关联的，以及对项目整体和相关模块的影响。
* **结果展示：** 可能需要展示变更前后的效果对比，如性能提升的指标、用户体验的改善等。

提供一个完整、透明的记录，使其他开发者、代码审查者或利益相关者能够清晰地理解发生了什么，为什么要这么做以及这些变更如何实施的。这样的描述有助于提高代码的可追踪性和团队间的协作效率。

**要高亮出现有的代码需要变更的内容、方式和时间**
* 需要使用一些视觉上的手段（比如文本格式、颜色高亮或标记）来区分哪些代码发生了变更，以便于审查和理解。
* 详细列出哪些代码行或模块被修改了，具体修改了什么内容，比如添加、删除或更新了哪些代码。
* 描述实施变更的方法，例如是通过直接编辑、使用版本控制系统进行提交，还是通过补丁程序等。
* 明确指出何时进行这些变更，这可能是实际变更的日期和时间，也可能是计划内的时间安排。

记录和通报代码变更时的清晰度和可追溯性。它要求开发者或团队不仅要记录变更的具体细节，还要通过高亮等手段使这些信息在视觉上容易辨识，以便其他团队成员或利益相关者能够快速理解变更的范围、方式和时机。这种做法有助于维护代码的历史记录，简化代码审查过程，以及确保项目的透明度和协同工作的效率。

**当引入任何新的抽象概念时，也需要描述出来**
* 需要描述代码中引入的任何新的结构或构思，它可能是为了改进代码的组织、重用性、可读性等方面。
* 不仅在代码中实现这些新的抽象，还要在代码的注释、提交消息、设计文档或其他形式的文档中提供说明。
* 应详细描述新概念的功能、目的、如何与现有代码相互作用，以及它是如何解决特定问题或改善系统的。
* 除了描述新概念本身，还应当解释为什么需要引入这个新概念，包括它带来的好处和可能的权衡。
* 提供这些详细描述的目的是为了确保代码的其他用户、开发者或审查者能够理解变更背后的逻辑，从而更好地维护和扩展代码。

进行代码变更时，必须考虑到沟通和文档记录的重要性，特别是当涉及到较为复杂或不直观的新抽象时。这有助于保持团队成员间的知识同步，并确保代码库的健康和可维护性。

## API变更点
**记录所有对现有的API的任何新增的API的改变**

当你在现有的API结构上增加新的功能、端点（endpoints）、方法或参数时，这些变动都应该被详细记录下来。
* 不仅包括新增，还包括对现有功能的任何修改，比如参数的变更、行为的改变、废弃的功能等。
* API变更点指的是具体的变化条目或记录，它们是API更新历史的一部分，为了追踪API的演进以及可能影响到的用户或系统。

* 这种记录工作对于API的使用者（通常是软件开发者）至关重要，因为它们需要知道：
  * 有哪些新功能可以利用；
  * 现有的哪些功能发生了变化，以及这些变化如何影响他们当前的代码；
  * 如果有API功能被废弃，他们需要知道如何进行替换或升级。

**讨论向前或向后的兼容性与版本问题**

这些都是确保API用户不会因为变更而遭受服务中断或功能损失的关键因素。良好的API管理应该避免不必要的不兼容变更，并且在引入这些变更时要有清晰的沟通和足够的过渡期。

**记录你的API提案中包含错误处理**

* 错误处理是API设计中的一个关键方面，因为良好的错误处理机制可以提高API的可用性、可靠性和易用性。通过记录错误处理的细节。
* 确保API的使用者在遇到问题时能够得到足够的信息来进行调试和问题解决。此外，这也是文档化最佳实践的一部分，有助于维护API的质量和提供良好的用户体验。

**当遇到不规则输入、违反约束条件、意外的内部错误或异常时，应该以有用的消息来响应**

在设计和维护API时，应该考虑全面的错误处理策略，并确保当错误发生时，返回给客户端的错误消息是清晰和有帮助的。这不仅有助于提升API的用户体验，还容易让开发者在出现问题时进行调试和问题解决。


## 持久层变更点（如涉及到则必说明）

**解释正在引入或已经修改的存储技术**

记录持久层的变更点是非常重要的，因为这些变更可能涉及到重要的数据结构和系统行为。透明的记录和解释这些变更对于团队成员来说是很有帮助的，能够确保每个人都在同一页面上，并理解变更背后的动机和预期的影响。此外，这也是必要的文档实践，有助于维护系统的稳定性和未来的可维护性。

**讨论新的数据库、文件和文件系统架构、检索的索引和数据传输管道**

强调需要关注这些关键组成部分的变化，并探讨它们对整个系统的影响。这包括但不限于系统性能、数据一致性、可用性、扩展性和维护的复杂性。变更点的讨论有助于团队成员了解新的设计和实现如何影响系统的数据层，以及这些变化对现有数据操作和业务逻辑的潜在影响。明确记录并讨论这些点是确保数据层平稳过渡和高效运营的重要部分。

**包括所有模式的变化并对其向后兼容性进行说明**

记录这些变更点并说明向后兼容性对于确保系统的稳定和预防数据丢失、服务中断至关重要。它也有助于团队成员、利益相关者和用户理解变更的影响，并在必要时做好准备和适当的更新。

## 日志和埋点
* 明确埋点和日志需要支持的业务目标和技术需求。例如，了解需要追踪哪些用户行为、监控哪些性能指标、满足哪些安全审计要求等。
* 基于目标和需求，确定需要记录的关键事件和指标。对于埋点来说，这可能包括页面访问量、按钮点击次数、用户注册流程的完成率等。对于日志，可能包括错误消息、系统警告、事务处理时间等。
* 阐述如何测试和验证埋点和日志的正确性和完整性。这可能包括自动化测试、手动测试检查点和审计日志的实践。


## 风险评估
**全面评估变更的潜在影响，我们从宏观角度出发，综合考虑以下几个方面：**
* 对变更造成的影响进行等级划分，以明确其严重程度。
* 界定变更影响的具体范围，包括哪些系统、流程或利益相关者将受到影响。
* 评估这些影响是否处于可控且可接受的范畴内。
* 针对识别的风险，我们将提出相应的规避策略，以确保变更的顺利实施，并最大限度地减少负面后果。

## 测试计划
**事先不要定义每项计划，而是去解释你计划如何去验证你的变更**

在设计测试计划之前，优先明确整体流程的设计理念和变更的关键验证点，然后根据这些信息来制定针对流程链路的验证策略。

**讨论测试数据的来源或生成方法，强调需要覆盖的用例**

通过分析测试数据的来源和生成方法，并强调所需覆盖的用例，可以增加测试的有效性，减少遗漏和缺陷，从而提升软件的质量和可靠性。这个过程也有助于识别可能需要额外关注的风险区域，以及优化测试过程中的数据管理和使用。

**讨论你期望使用的类库和测试策略**

在测试过程开始之前，需要有一个充分的讨论环节，以便为接下来的测试活动选择适当的工具和形成一套明确的指导方针。这有助于确保测试工作的质量和效率，同时减少测试过程中可能出现的问题。

**解释你讲如何验证安全性的需求是否得到满足**
* 这里可以概述下，你目前计划对安全性进行测试的测试方案。在验证之前，必须清楚地定义和理解安全性需求。同时确保测试活动不会对实际的生产环境造成风险。
* 检查第三方库和软件是否存在已知的安全问题，并确保系统配置（如服务器设置、数据库权限）符合安全标准。
* 对发现的安全问题进行分类和优先级排序，然后制定修复策略。对于严重的或高风险漏洞，应马上制定修复措施。
* 确保软件在设计、开发和部署各个阶段都达到预期的安全标准。

系统地验证软件的安全性需求是否得到满足，确保软件在设计、开发和部署各个阶段都达到预期的安全标准。

## 发布计划
**描述你进行采用的策略，以避免复杂的部署顺序需求**

制定初步的发布计划，明确系统的直接依赖关系，并按照这些依赖顺序逐步进行发布。

**记录你需要设置特性开关，以控制新版本的展开**
* 需要表明在进行新版本发布前，需要识别哪些功能将会通过特性开关进行控制。要有明确的文档化过程，列出所有的特性开关，以及它们各自控制的功能和相关的配置信息。
* 还需说明如何逐步向用户推出新功能，先从一个小用户群体开始，逐渐扩大范围，以便于监测和评估新版本的表现。

**你的发布的变更是否生效？以及在发现问题时你将如何回滚**

* 请描述在发布后如何验证需求变更的有效性，并阐明可用于监测日志异常的方法。
* 在异常出现时，立即对其进行优先级分类，并迅速执行事先制定的应急措施以控制状况，确保影响最小化。

## 遗留的问题
**明确地列出设计中尚未回答的紧迫问题**
* 需要清晰地指出那些在目前的设计阶段还未解决的关键问题。这些遗留问题通常是紧急的，需要尽快解决，因为它们可能对项目的进展、质量或最终交付有显著影响。

有助于保证团队成员对于现存的挑战有共同的理解，同时为项目的接下来的步骤提供一个清晰的行动指南。此外，这也能够帮助避免在项目后期出现意外的阻碍，确保所有关键风险都被妥善管理。

**并说明你的“已知的未知”**

能够识别并记录“已知的未知”是非常重要的。这有助于团队评估潜在的风险，制定应对计划，分配资源去探索这些问题的答案，并确保在项目进展中对这些问题保持关注。通过这样的处理，团队可以更加明智地做出决策，并提高项目成功的可能性。

## 项目总结/复盘（可选）
* 项目开发或上线后，对整个流程进行的总结、复盘。

围绕本次需求的总结内容皆可。一方面可以通过总结的方式弥补提升自己，二来可以留痕为读者更方面理解全文的内容和方向。

## 附录
* 加入额外的令人感兴趣的细节。
* 添加相关工作参考

提供研究线索不仅有助于引导读者，也是对自己研究过程的有效回顾。

_________________

## 感谢（题外话）🌸

> 本节内容参考了 《程序的README》 -- 10.3 撰写设计文档
